# Instructions

## PRD

根据 @specs/w7/genslide.jpg 的内容，仔细阅读并思考，生成一个 ./specs/w7/0001-prd.md 的
  PR。要求：使用中文。这个 app 是一个本地运行的单页 app，使用 nano banana pro 生成图片
  slides，可以以走马灯的形式全屏播出。后端使用 Python，前端使用 Typescript。

## 修改 PRD

specs/w7/0001-prd.md 需要修改：

1. 图片生成使用 google ai sdk
2. 对于侧边栏 slide，选中并拖拽可以改变顺序
3. 文本内容变化后，如果图片中没有对应文本hash的图片，在主图片区域下放一个按钮，用户点击可以生
成新的图片
4. outline.yml 中需要保存用户选择的风格图片。当第一次打开时，如果没有风格图片，需要有个
popup，用户可以输入一段文字，生成两个图片，让用户选择，用户选中的作为 slides
的风格，以后生成新的图片时参考这张图片
5. Nano Banana Pro API key -> Genimi API key

## 生成 design spec

根据 ./specs/w7/0001-prd.md 和 @specs/w7/genslide.jpg 的内容，生成一个 design spec，放在 ./specs/w7/0002-design-spec.md 文件中。要求：使用中文，注意所有前端所需的 API 接口要定义清楚。整体项目的目录结构也要定义清楚，后端代码层次清晰，API/业务/存储要保持清晰的边界。

## 生成目录结构

根据 ./specs/w7/0002-design-spec.md 的内容，生成项目的空的目录结构。先不要生成代码。在 backend/ 和 frontend/ 目录下分别生成 CLAUDE.md 文件，内容考虑：

- 所使用语言框架的 best practices
- 架构设计遵循的原则：SOLID/YAGNI/KISS
- 代码的组织结构
- 并发处理
- 错误处理和日志处理

## 生成代码

根据 @specs/w7/0002-design-spec.md 的内容，启动 python 和 typescript 两个 agent 分别撰写后端和前端的代码。代码在 ./w7/genslides 下。

## 页面风格

使用浅黄色 / 红褐色的水彩画风格，走可爱卡通路线，主要角色是一只黄色的可爱的鸭子，类似 motherduck 的风格

## 代码生成问题

创建风格图片出错：

```bash
  INFO:     127.0.0.1:64661 - "POST /api/slides/gen-slides HTTP/1.1" 201 Created
  INFO:     127.0.0.1:64676 - "GET /api/slides/gen-slides HTTP/1.1" 200 OK
  INFO:     127.0.0.1:64678 - "GET /api/slides/gen-slides HTTP/1.1" 200 OK
  INFO:     127.0.0.1:64680 - "GET /api/slides/gen-slides/slide_796aaf30/images HTTP/1.1" 200 OK
  INFO:     127.0.0.1:64684 - "GET /api/slides/gen-slides/slide_796aaf30/images HTTP/1.1" 200 OK
  INFO:     127.0.0.1:65162 - "POST /api/slides/gen-slides/style/generate HTTP/1.1" 404 Not
  Found
```

请仔细阅读前后端代码，确保他们 API 的实现符合 ./specs/w7/0002-design-spec.md。如果是 design spec 里缺失的 API，请在 design spec 里添加，并确保前后端一致

生成风格并未生成相应的图片，在 ./slides目录下没有相应的 <slug>/outline.yml 生成。请确保前后端逻辑正确。
